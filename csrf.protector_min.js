(function(){PXHR=function(e){if(!e){this.original=new window.oldXMLHttpRequest}else{this.original=new window.oldXMLHttpRequest(e)}var t=this;this.original.onreadystatechange=function(){t._updateProps();return t.onreadystatechange?t.onreadystatechange():null};this._updateProps();this.original.onload=function(){return t.onload?t.onload():null}};PXHR.prototype={abort:function(){return this.original.abort()},getAllResponseHeaders:function(){return this.original.getAllResponseHeaders()},getResponseHeader:function(e){return this.original.getResponseHeader(e)},overrideMimeType:function(){return this.original.overrideMimeType()},send:function(e){return this.original.send(e)},setRequestHeader:function(e,t){return this.original.setRequestHeader(e,t)},open:function(e,t,n,r,i){if(e.toLowerCase()=="get"&&this.sameServer(t)&&!t.contains("csrftoken")){if(t.contains("?")){t+="&csrftokenAjax=1&csrftoken="+this.getToken(t)}else{t+="?csrftokenAjax=1&csrftoken="+this.getToken(t)}}if(r){return this.original.open(e,t,n,r,i)}return this.original.open(e,t,n)}};PXHR.prototype.onreadystatechange=function(){};PXHR.prototype._updateProps=function(){this.readyState=this.original.readyState;this.timeout=this.original.timeout;this.upload=this.original.upload;this.withCredentials=this.original.withCredentials;if(this.readyState==4){this.response=this.original.response;this.responseText=this.original.responseText;this.responseType=this.original.responseType;this.responseXML=this.original.responseXML;this.status=this.original.status;this.statusText=this.original.statusText;this.updateCsrftoken()}};PXHR.prototype.sameServer=function(e){return e.toLowerCase().contains(server)||!e.toLowerCase().contains("http")};PXHR.prototype.getToken=function(e){e=this.pathinfo(e);if(typeof csrftoken[e]!="undefined"){return csrftoken[e]}return csrftoken["global"]};PXHR.prototype.updateCsrftoken=function(){var e=document.getElementById("csrftokenUpdater");if(e==null)return;var t=document.createElement("script");t.type="text/javascript";t.text=e.text;e.remove();document.getElementsByTagName("head")[0].appendChild(t)};PXHR.prototype.pathinfo=function(e){return"/"+e.replace(/^(?:\/\/|[^\/]+)*\//,"")};Element.prototype.remove=function(){this.parentElement.removeChild(this)};NodeList.prototype.remove=HTMLCollection.prototype.remove=function(){for(var e=0,t=this.length;e<t;e++){if(this[e]&&this[e].parentElement){this[e].parentElement.removeChild(this[e])}}};if(window.XMLHttpRequest){window.oldXMLHttpRequest=window.XMLHttpRequest;window.XMLHttpRequest=PXHR}else if(window.ActiveXObject){window.oldXMLHttpRequest=window.ActiveXObject;window.ActiveXObject=PXHR}})()